{% extends 'base.html.twig' %}

{% block title %}Register{% endblock %}

{% block body %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 to-blue-100 p-6">

    <div class="bg-white w-full max-w-5xl rounded-3xl shadow-2xl flex overflow-hidden">

        <!-- LEFT IMAGE -->
        <div class="hidden md:flex md:w-1/2 bg-indigo-600 items-center justify-center p-10">
            <img src="{{ asset('images/kayouta.png') }}" class="w-80 drop-shadow-2xl">
        </div>

        <!-- RIGHT FORM -->
        <div class="w-full md:w-1/2 p-10">

            <h2 class="text-3xl font-bold text-indigo-600 mb-8 text-center">
                Créer un compte
            </h2>

            {% for message in app.flashes('error') %}
                <div class="mb-4 rounded-xl bg-red-100 p-3 text-sm text-red-800">
                    {{ message }}
                </div>
            {% endfor %}

            {{ form_errors(registrationForm) }}

            {{ form_start(registrationForm) }}

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

                {{ form_errors(registrationForm.firstName) }}
                {{ form_widget(registrationForm.firstName, {
                    'attr': {
                        'placeholder': 'First Name',
                        'class': 'w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

                {{ form_errors(registrationForm.lastName) }}
                {{ form_widget(registrationForm.lastName, {
                    'attr': {
                        'placeholder': 'Last Name',
                        'class': 'w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

                {{ form_errors(registrationForm.email) }}
                {{ form_widget(registrationForm.email, {
                    'attr': {
                        'placeholder': 'Email Address',
                        'class': 'col-span-2 w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

                {{ form_errors(registrationForm.password) }}
                {{ form_widget(registrationForm.password, {
                    'attr': {
                        'placeholder': 'Password',
                        'class': 'col-span-2 w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

                {{ form_widget(registrationForm.phoneNumber, {
                    'attr': {
                        'placeholder': 'Phone Number',
                        'class': 'w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

                {{ form_widget(registrationForm.age, {
                    'attr': {
                        'placeholder': 'Age',
                        'class': 'w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

            </div>

            <div class="mt-4">
                {{ form_widget(registrationForm.role, {
                    'attr': {
                        'class': 'w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}
            </div>

            <div id="coach-fields" class="mt-4 hidden space-y-4">

                {{ form_widget(registrationForm.speciality, {
                    'attr': {
                        'placeholder': 'Speciality',
                        'class': 'w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

                {{ form_widget(registrationForm.availability, {
                    'attr': {
                        'placeholder': 'Availability',
                        'class': 'w-full border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400 focus:outline-none'
                    }
                }) }}

            </div>

            <button type="submit"
                class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-xl transition duration-300">
                S'inscrire
            </button>

            <p class="mt-4 text-center text-sm text-gray-600">
                Déjà inscrit ? <a href="{{ path('app_login') }}" class="text-indigo-600 font-medium hover:underline">Se connecter</a>
            </p>

            {{ form_end(registrationForm) }}

        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
<script>
document.addEventListener("DOMContentLoaded", function() {

    const roleSelect = document.querySelector('[name$="[role]"]');
    const coachFields = document.getElementById("coach-fields");

    function toggleCoachFields() {
        if (roleSelect.value === "ROLE_COACH") {
            coachFields.classList.remove("hidden");
        } else {
            coachFields.classList.add("hidden");
        }
    }

    roleSelect.addEventListener("change", toggleCoachFields);
    toggleCoachFields();
});
</script>
{% endblock %}
