<!-- Active Routines Card -->
<div class="card bg-transparent border h-100">
    <div class="card-header bg-transparent border-bottom">
        <h5 class="card-header-title mb-0">Active Routines</h5>
    </div>
    <div class="card-body">
        <h2 class="mb-0">{{ totalRoutines|number_format }}</h2>
        <p class="mb-3 text-muted">Total Active Routines</p>
        
        <!-- Donut Chart -->
        <div id="activeRoutinesChart"></div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var options = {
        series: [{{ routinesByGoal.fitness }}, {{ routinesByGoal.education }}, {{ routinesByGoal.productivity }}, {{ routinesByGoal.wellness }}],
        chart: {
            type: 'donut',
            height: 250,
        },
        labels: ['Health & Fitness', 'Education', 'Productivity', 'Wellness'],
        colors: ['#066ac9', '#0cbc87', '#f7c32e', '#17a2b8'],
        legend: {
            position: 'bottom',
            fontSize: '13px',
        },
        dataLabels: {
            enabled: false
        },
        plotOptions: {
            pie: {
                donut: {
                    size: '65%',
                    labels: {
                        show: false
                    }
                }
            }
        },
        tooltip: {
            y: {
                formatter: function(value, { seriesIndex, w }) {
                    const labels = ['Health & Fitness', 'Education', 'Productivity', 'Wellness'];
                    return labels[seriesIndex] + ': ' + value + ' routines';
                }
            }
        },
        responsive: [{
            breakpoint: 480,
            options: {
                chart: {
                    height: 200
                },
                legend: {
                    position: 'bottom'
                }
            }
        }]
    };

    var chart = new ApexCharts(document.querySelector("#activeRoutinesChart"), options);
    chart.render();
});
</script>
